## -*- mode:ulam -*-
#=t41695_test_compiler_multiinheritance_nonlocaldminsubaddsbaseconstantshadows_error
##
#!
./E4.ulam:3:15: ERROR: Variable 'self' is not defined, or was used before declared in a function.
./E4.ulam:3:15: ERROR: Member selected, self, is invalid here.
./E4.ulam:3:21: ERROR: Variable 'self' is not defined, or was used before declared in a function.
./E4.ulam:3:21: ERROR: Member selected, self, is invalid here.
./E4.ulam:3:3: ERROR: Initial value expression for: m_add, initialization is invalid.
Unrecoverable Program Type Label FAILURE.
##
## A subclass DM, m_add in E4, behaves differently than as local var (t41692);
##  QBase2.m_q has to be a constant, QBase3.m_q specified (see also t41693,4).
##
#>Foo.ulam
  ulam 5;
element Foo +System {
  Int m_qadd;
  Int test()
  {
    E4 e4;
    m_qadd = e4.getAdd();
    print(m_qadd);
    assert(m_qadd==2);
    return m_qadd;
  }
}


#:E4.ulam
  ulam 5;
element E4 : QBase2 +QBase3 +QBaseLast {
  Int m_add = m_q + m_q; // ==2  doesn't work as DM t41693
  Int getAdd(){
    //Int m_add = m_q + m_q; // ==2  works as local var t41692
    return m_add;
  }
}

#:QBase1.ulam
    ulam 4;
quark QBase1 {
}

#:QBase2.ulam
  ulam 5;
quark QBase2 +QBase1 {
  Int(8) m_q = 1; //first one has to be a constant for this to work t41694
}

#:QBase3.ulam
  ulam 4;
quark QBase3 : QBase1 {
  constant Int(8) m_q = 4;
}

#:QBaseLast.ulam
  ulam 4;
quark QBaseLast {
  Int(8) m_q = 17;
}


#:System.ulam
ulam 1;
quark System {
Void print(Unsigned arg) native;
Void print(Int arg) native;
Void print(Int(4) arg) native;
Void print(Int(3) arg) native;
Void print(Unary(3) arg) native;
Void print(Bool(3) arg) native;
Void assert(Bool b) native;
}

#.
