## -*- mode:ulam -*-
#=t41665_test_compiler_templatedelementbaseclasswithzerolengtharray_ish
##  gen output: (+ 2 asserts interleaved)
##     Unsigned Arg: 0
##     Unsigned Arg: 4
#!
Exit status: 0
Ue_R { Unsigned z(0u);  Unsigned y(4u);  Int test() {  System s;  XBarSpace2D xbar;  self z . 0u = s ( self z . )print . s ( self z . 0u cast == )assert . self y . 4u = s ( self y . )print . s ( self y . 4u cast == )assert . self z . cast return } }
Uq_System { <NOMAIN> }
Ue_XBarSpace2D : LocalSpace2DT(7u,1u,4u,7u,0u) { /* empty class block */ }
Uq_LocalSpace2DT(Unsigned cBITS, Unsigned cTAGBITS, Unsigned cGRIPBITS, Unsigned cGRADBITS, Unsigned cGRADS) { Unsigned(UNKNOWN) mGrips(notready);  typedef GradientStgT(cBITS) OurGradient;  GradientStgT(cBITS) mOurGradients[UNKNOWN](notready);  <NOMAIN> }
Uq_GradientStgT(Unsigned cBITS) { typedef Unsigned(UNKNOWN) GradValStg;  constant Unsigned(UNKNOWN) cUNINIT_GRADVAL = unresolved maxof .;  Unsigned(UNKNOWN) mGradVal(notready);  <NOMAIN> }
##
##      6/9/2024 Dave's ISH showed mangled name Uq_n11179212GradientStgT11102321u17 for QSpace2D
##      arraysize -1 (Uq_n1117..), instead of 0 (Uq_1017..), to distinquish
##      zero length array from its scalar type. Situation generated in LocalSpace2DT _Types.h.
##      (also see UlamTypeClass.cpp getUlamTypeMangledType()).
##
#>R.ulam
  ulam 5;
element R {
  Unsigned z;
  Unsigned y;
  Int test(){
    System s;
    XBarSpace2D xbar;
    z = xbar.mOurGradients.sizeof;
    s.print(z);
    s.assert(z==0u);
    y = xbar.mGrips.sizeof;
    s.print(y);
    s.assert(y==4u);
    return (Int) z; //ZERO!!
  }
}

#:XBarSpace2D.ulam
  ulam 5;
local typedef LocalSpace2DT(7u,1u,4u,7u,0u) QSpace2D;

element XBarSpace2D : QSpace2D
{ }

#:LocalSpace2DT.ulam
  ulam 5;
quark LocalSpace2DT(Unsigned cBITS,Unsigned cTAGBITS,Unsigned cGRIPBITS, Unsigned cGRADBITS, Unsigned cGRADS) {
  Unsigned(cGRIPBITS) mGrips;
  typedef GradientStgT(cGRADBITS) OurGradient;
  OurGradient mOurGradients[cGRADS];

}

#:GradientStgT.ulam
  ulam 5;
quark GradientStgT(Unsigned cBITS) {
  typedef Unsigned(cBITS) GradValStg;
  constant GradValStg cUNINIT_GRADVAL = GradValStg.maxof;
  GradValStg mGradVal = cUNINIT_GRADVAL;
}

#:System.ulam
  ulam 1;
quark System {
  Void print(Unsigned arg) native;
  Void print(Int arg) native;
  Void print(Int(4) arg) native;
  Void print(Int(3) arg) native;
  Void print(Unary(3) arg) native;
  Void print(Bool(3) arg) native;
  Void assert(Bool b) native;
}

#.
