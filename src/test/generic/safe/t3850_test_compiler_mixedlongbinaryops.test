## -*- mode:ulam -*-
#=t3850_test_compiler_mixedlongbinaryops
##
## gen output:
## assert: arg is 1
## after assert's abort: arg is 1
## Int Arg: 56798
## Int Arg: -56798
## Int Arg: 0
## assert: arg is 1
## after assert's abort: arg is 1
## assert: arg is 1
## after assert's abort: arg is 1
## assert: arg is 1
## after assert's abort: arg is 1
## assert: arg is 1
## after assert's abort: arg is 1
## assert: arg is 1
## after assert's abort: arg is 1
## assert: arg is 1
## after assert's abort: arg is 1
## assert: arg is 1
## after assert's abort: arg is 1
## Int Arg: -28399
## assert: arg is 1
## after assert's abort: arg is 1
## Int Arg: 4
## assert: arg is 1
## after assert's abort: arg is 1
## assert: arg is 1
## after assert's abort: arg is 1
## assert: arg is 1
## after assert's abort: arg is 1
## assert: arg is 1
## after assert's abort: arg is 1
## Int Arg: -113596
## assert: arg is 1
## after assert's abort: arg is 1
## assert: arg is 1
## after assert's abort: arg is 1
## Int Arg: 2147483647
## Int Arg: -113596
## Int Arg: -28399
## Int Arg: 2147455249
## assert: arg is 1
## after assert's abort: arg is 1
##
#!
Exit status: 0
Ue_A { constant Int(64) j = -56798;  Int(32) i(-56798);  Int(32) n(56798);  Int(32) test() {  System s;  s ( true )assert . n 56798 cast = i -56798 cast = s ( n )print . s ( i )print . s ( i n +b )print . s ( i n +b 0 cast == )assert . Int(64) mixsum64 = n cast -56798 +b;  Int(32) mixsum32 = -56798 n cast +b cast;  s ( mixsum64 0 cast == )assert . s ( mixsum32 0 cast == )assert . Int(64) mixdiff64 = -56798 n cast -b;  Int(32) mixdiff32 = -56798 n cast -b cast;  s ( mixdiff64 -113596 == )assert . s ( mixdiff32 2 cast i * == )assert . s ( mixdiff64 mixdiff32 cast == )assert . Int(64) mixprod64 = -113596;  Int(32) mixprod32 = -113596 cast;  s ( mixprod64 mixprod32 cast == )assert . Int(64) mixdiv64 = -28399;  Int(32) mixdiv32 = -28399 cast;  s ( mixdiv32 )print . s ( mixdiv64 mixdiv32 cast == )assert . s ( mixprod32 mixdiv32 / )print . s ( mixprod32 cast mixdiv64 / cast 4 cast == )assert . s ( mixprod64 mixdiv32 cast / 4 cast == )assert . s ( mixprod64 mixdiv32 cast / 4 cast == )assert . s ( mixprod32 cast mixdiv64 / cast 4 cast == )assert . Int(64) mixlshift64 = 18446744073709438020u cast;  Int(32) mixlshift32 = 18446744073709438020u cast;  s ( mixlshift32 )print . s ( mixlshift32 mixprod32 == )assert . s ( mixlshift64 mixlshift32 cast == )assert . Int(64) mixrshift64 = 9223372036854747409u cast;  Int(32) mixrshift32 = 9223372036854747409u cast;  s ( mixrshift32 )print . s ( mixprod32 )print . s ( mixdiv32 )print . s ( i cast 1 cast >> cast )print . s ( mixrshift64 mixrshift32 cast != )assert . i n +b return } }
Uq_System { <NOMAIN> }
##
## informed by error/t3849
##
#>A.ulam
 ulam 2;
element A {
  constant Int(64) j = (Int) 0xffff2222;
  Int i;
  Int n;
  Int test () {
    System s;
    s.assert(j < 0);

    n = (Int) -j; //found assert in NodeUnaryOp
    i = (Int) j;
    s.print(n);
    s.print(i);
    s.print(i + n);
    s.assert((i + n) == 0);

    Int(64) mixsum64 = n + j; //j + n;
    Int mixsum32 = (Int) (j + n); //explicit cast req'd
    s.assert(mixsum64 == 0);
    s.assert(mixsum32 == 0);

    Int(64) mixdiff64 = j - n;
    Int mixdiff32 = (Int) (j - n); //explicit cast req'd
    s.assert(mixdiff64 == 2 * j);
    s.assert(mixdiff32 == 2 * i);
    s.assert(mixdiff64 == mixdiff32);

    Int(64) mixprod64 = 2 * j;
    Int mixprod32 = (Int) (j * 2); //explicit cast req'd
    s.assert(mixprod64 == mixprod32);

    Int(64) mixdiv64 = j / 2;
    Int mixdiv32 = (Int) (j / 2); //explicit cast req'd
    s.print(mixdiv32); // -28399
    s.assert(mixdiv64 == mixdiv32);

    s.print(mixprod32/mixdiv32);
    s.assert(mixprod32 / mixdiv64 == 4);
    s.assert(mixprod64 / mixdiv32 == 4);
    s.assert(mixprod64 / mixdiv32 == 4);
    s.assert(mixprod32 / mixdiv64 == 4);


    Int(64) mixlshift64 = j << 1;
    Int mixlshift32 = (Int) (j << 1); //explicit cast req'd
    s.print(mixlshift32); //-113596
    s.assert(mixlshift32 == mixprod32);
    s.assert(mixlshift64 == mixlshift32);

    Int(64) mixrshift64 = j >> 1;
    Int mixrshift32 = (Int) (j >> 1); //explicit cast req'd
    s.print(mixrshift32); //2147483647
    s.print(mixprod32); // -113596
    s.print(mixdiv32); // -28399
    s.print((Int) (i >> 1)); //2147455249

    s.assert(mixrshift64 != mixrshift32);

    return (i + n);
  }
}

#:System.ulam
ulam 1;
quark System {
Void print(Unsigned arg) native;
Void print(Int arg) native;
Void print(Int(4) arg) native;
Void print(Int(3) arg) native;
Void print(Unary(3) arg) native;
Void print(Bool(3) arg) native;
Void assert(Bool b) native;
}
#.
